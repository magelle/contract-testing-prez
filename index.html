<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>N’ayez plus peur de refactorer vos API WEB</title>

		<link rel="stylesheet" href="css/reset.css">
		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/moon.css ">
		<link rel="stylesheet" href="css/custom.css">


		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/monokai.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<h4>N’ayez plus peur</h4>
					<img src="images/refactor-meme.jpg" 
						 alt="Refactor or don't that is the question" />
					<h4>de refactorer vos API WEB</h4>
				</section>
				<section>
					<h3>Jessica</h3>
					<h1>&</h1>
					<h3>Maxime</h3>
				</section>
				
				<section>
					<section>
						<h2>#micro-services !!!</h2>
						<img src="images/thumb-up.gif" alt="Thumb up" />
					</section>
					<section>
						<h3>Notre architecture</h3>
						<img src="images/microservices-architecture.png" 
							 alt="Notre super architcture, bon c'est un peu compliqué" 
							 height="500px"/>
					</section>
				</section>
				
				<section>
					<section>
						<h3>New feature</h3>
						<img src="images/jenga-machines.gif" 
						alt="Add it without breaking everything" />
					</section>
					<section>
						<h3>Modifier une API</h3>
						<ul>
							<li>Combien ça va coûter ?</li>
							<li>Comment pas tout casser ?</li>
						</ul>
						<img src="images/peur.gif" alt="On a peur" />
					</section>
					<section>
						<h2>Ce qui serait génial</h2>
						<aside class="notes">
							C'est trop long ces points
						</aside>
					</section>
					<section>
						<h3>Une carte</h3>
						<img src="images/map-interaction.jpg" alt="interaction map" />
					</section>
					<section>
						<h3>Les formats</h3>
						<img src="images/form-to-fill.jpg" alt="interaction format"/>
						<aside class="notes">Les formats d'échanges, les vérifier</aside>
					</section>
					<section>
						<h3>Voir le future</h3>
						<img src="images/crystal-ball.jpg" alt="Crystal ball" />
						<aside class="notes">
							<ul>
								<li>ça va fonctionner ?</li>
								<li>Qui va cassé ?</li>
								<li>Qui est impacté</li>
								<li>...</li>
							</ul>
						</aside>
					</section>
					<section>
						<h3>En gros</h3>
						<img src="images/layer-architecture.png" alt="Un service" 
						     height="500px"/>
					</section>
					<section>
						<h3>D'habitude on test ça</h3>
						<img src="images/tested-layer-architecture.png" alt="Un service"
						     height="500px"/>
					</section>
					<section>
						<h3>Mais ...</h3>
						<img src="images/not-tested-layer-architecture.png" alt="Interaction entre deux services"
							 height="500px"/>
						<aside class="notes">
							Mais les interactions sont mocké
						</aside>
					</section>
					<section>
						<h3>Autrement dit</h3>
						<img src="images/interactions-to-test.png" 
						     alt="Interaction entre les services"
							 height="500px"/>
					</section>
				</section>

				<section>
					<section>
						<h2>Contract Testing !</h2>
					</section>
					<section>
						<h3>Tester les interactions</h3>
						<img src="images/contract-testing-principle.png" 
								alt="both consumer and provider should verify the contract" />
						<aside class="notes">
							Tester les interactions entre consumer et provider
						</aside>
					</section>
					<section>
						<h3>Provider</h3>
						<blockquote>Celui qui propose l'API</blockquote>
						<p>Exemple: Mon service REST</p>
						
						<aside class="notes">
							An application (often called a service) that provides functionality or data for other applications to use, often via an API.

							For applications that use HTTP, the provider is the application that returns the response.
							For applications that use queues, the provider (also called producer) is the application that writes the messages to the queue.
						</aside>
					</section>
					<section>
						<h3>Consumer</h3>
						<blockquote>Celui qui appelle l'API</blockquote>
						<p>Exemple: Mes clients Angular</p>
						
						<aside class="notes">
							An application that makes use of the functionality or data from another application to do its job.

							For applications that use HTTP, the consumer is always the application that initiates the HTTP request (eg. the web front end), regardless of the direction of data flow.
							For applications that use queues, the consumer is the application that reads the message from the queue.
						</aside>
					</section>
					<section>
						<h3>Comment ?</h3>
						<img src="images/contract-testing-mocks.png" 
								alt="Un contract, tester avec des mocks" 
								width="500px"/>
					</section>
					<section>
						<h2>On définit un contrat</h2>
						<img src="images/a-contract-and-interactions.png" alt="Un contract" 
						     width="500px"/>
					</section>
					<section>
						<h2>Et des interactions</h2>
						<img src="images/interaction.png" alt="Une interaction" 
						     width="500px"/>
					</section>
				
					<section>
						<h4>Test d'un provider</h4>
						<img src="images/test-provider.png"/>
					</section>
					<section>
						<h4>Test d'un consumer</h4>
						<img src="images/test-consumer.png"/>
					</section>
					<section>
						<h2>Au global</h2>
						<img src="images/both-tests.png" alt="Global view">
					</section>
				</section>

				<section>
					<section>
						<h3>Qui définit le contrat ?</h3>
						<h4>Consumer driven VS Provider driven</h4>
					</section>

					<section>
						<h3>Provider Driven</h3>
						<blockquote>Je fonctionne de cette manière</blockquote>
						<img src="" alt="Un contrat pour tous les consumers" />
 					</section>

					<section>
						<h3>Consumer Driven</h3>
						<blockquote>J'ai besoin de ça</blockquote>
						<img src="" alt="Plusieurs contract pour un provider" />
					</section>

					<section>
						<h2>C'est qui le plus fort ?</h2>
					</section>

					<section>
						<h3>Quand faire du provider driven ?</h3>
                        <ul>
							<li>Consumers inconnus</li>
							<li>Beaucoup de consumers</li>
							<li>API Publique</li>
                        </ul>
					</section>
					<section>
						<h3>Quand faire du consumer driven ?</h3>
                        <ul>
							<li>Peu de consumers</li>
                            <li>Micro-services</li>
						</ul>
					</section>
					<!--section>
						<h3>Avantage au Consumer Driven !</h3>
						<aside class="notes">
							Je suis pas sûr que l'un est mieux que l'autre.
							ça répond juste pas aux mêmes besoins.
						</aside>
					</section>
					<section>
						<h4>Identifier les interfaces utilités par les consumers</h4>
						<img src="images/unused-interface.jpg"/>
					</section>
					<section>
						<h4>Verifier l'utilisation des services</h4>
						<img src="images/well-fittedness.jpg"/>
					</section-->

				</section>

				<section>
					<section>
						<img src="images/pact-logo.png" alt="Pact logo" >
					</section>
					<section>
						<h3>Polyglote</h3>
						<img src="images/logo-techno/ruby.png" height="100px">
						<img src="images/logo-techno/java.png" height="100px">
						<img src="images/logo-techno/dotnet.png" height="100px">
						<img src="images/logo-techno/go.png" height="100px">
						<img src="images/logo-techno/javascript.png" height="100px">
						<img src="images/logo-techno/swift.png" height="100px">
						<img src="images/logo-techno/php.png" height="100px">		
					</section>
					<section>
						<h3>Pourquoi ?</h3>
						<ul>
							<li>Open source</li>
							<li>Communauté active</li>
							<li>Bien documenté</li>
							<li>Polyglotte</li>
						</ul>
					</section>
					<section>
						<h3>Pact Broker</h3>
						<ul>
							<li>Regroupe les Pacts</li>
							<li>Documentation</li>
							<li>Carte des microservices</li>
						</ul>
					</section>
					<section>
						<h3>Contract Testing vs E2E Test</h3>
						<ul>
							<li>Moins complexe</li>
							<li>Feedback plus rapide</li>
							<li>Plus stable</li>
						</ul>
					</section>
				</section>
				<section><B></B>
					<section>
						<h2>Notre cas</h2>
						<img src="images/use-case.png" />
					</section>
					<section>
						<h2>Démo</h2>
					</section>
					<section>
						<h3>Passer de</h3>
						<pre><code class="hljs json">{
	"id": 123,
	"name": "mon produit",
	"price": 499.99
}</code></pre>
						<h3 class="fragment fade-in">à</h3>
						<pre class="fragment fade-in"><code class="hljs json">{
	"id": 123,
	"name": "mon produit",
	"price": {
		"amount": 499.99,
		"currency": "EUR"
	}
}</code></pre>
					</section>
					<section>
						<h2>Démo</h2>
						<aside class="notes">
							Scénario :
							- On veut modifier l'amount en currency
								=> fail d'un seul des deux contracts
							- On veut ajouter le stock sur un des consumer
						</aside>
					</section>
				</section>

				<section>
					<section>
						<h2>Conclusion</h2>
					</section>
					<section>
						<table>
							<thead>
								<tr>
									<td>Do</td>
									<td>Don't</td>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td>
										<ul>
											<li>Tests d'interactions</li>
											<li>Tests du format d'échange</li>
										</ul>
									</td>
									<td>
										<ul>
											<li>Tests fonctionnels</li>
											<li>Tests de charge</li>
										</ul>
									</td>
								</tr>
							</tbody>
						</table>
					</section>
				</section>

				<section>
					<h2>Questions ?</h2>
				</section>

			</div>
		</div>

		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true }
				]
			});
		</script>
	</body>
</html>
